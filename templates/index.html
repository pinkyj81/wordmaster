{% extends "base.html" %}
{% block content %}

<h2 class="text-2xl font-semibold mb-6 text-gray-800">í…ìŠ¤íŠ¸ ê¸°ë¡</h2>

<!-- ìƒë‹¨ í•„í„°/ê²€ìƒ‰ -->
<div class="flex flex-wrap items-center justify-between mb-6 space-y-2 sm:space-y-0">
  <div class="flex items-center space-x-2">
    <select class="border rounded-md px-2 py-1 text-sm">
      <option>ëª¨ë“  ì¶œì²˜</option>
    </select>
    <select class="border rounded-md px-2 py-1 text-sm">
      <option>ì œëª©ìˆœ</option>
      <option>ìµœê·¼ìˆœ</option>
    </select>
  </div>

  <input type="text" placeholder="ì œëª©, ë‚´ìš©, ì¶œì²˜ ê²€ìƒ‰..."
         class="border px-3 py-1 rounded-md w-64 text-sm focus:outline-none focus:ring-1 focus:ring-blue-400">
</div>

<!-- í…ìŠ¤íŠ¸ ëª©ë¡ -->
<div class="space-y-3">
  {% for text in texts %}
  <div class="flex justify-between items-center p-4 bg-white rounded-lg shadow-sm border hover:shadow-md transition">
    <!-- ì œëª© ë° ì •ë³´ -->
    <div>
      <p class="font-medium text-gray-800">{{ text.title }}</p>
      <p class="text-sm text-gray-500">ì €ì¥ëœ ë‹¨ì–´: {{ text.word_count }}ê°œ Â· í•™ìŠµ ì™„ë£Œ: 0ê°œ</p>
    </div>

    <!-- ë²„íŠ¼ ì˜ì—­ -->
    <div class="flex items-center space-x-2">
      <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded"
              onclick="openTextModal('{{ text.title }}', `{{ text.content|e }}`)">
        ì½ê¸°
      </button>

      <a href="/flashcards/{{ text.id }}" 
         class="bg-indigo-500 hover:bg-indigo-600 text-white px-3 py-1 rounded">ì•”ê¸°ì¹´ë“œ</a>

      <a href="/test/{{ text.id }}"
   class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded">TEST</a>

      <button onclick="deleteText('{{ text.id }}')"
              class="bg-red-100 hover:bg-red-200 text-red-600 rounded px-2 py-1">
        ğŸ—‘
      </button>
    </div>
  </div>
  {% endfor %}
</div>

<!-- âœ… í…ìŠ¤íŠ¸ ì½ê¸° íŒì—… -->
<div id="textModal"
     class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm">
  <div class="bg-white rounded-2xl shadow-2xl w-[90%] max-w-4xl p-10 max-h-[80vh] overflow-y-auto
              border border-gray-200">
    <!-- ì œëª© -->
    <h3 id="modalTitle"
        class="text-center text-2xl font-medium mb-8 text-gray-800 tracking-tight font-['Noto_Serif']"></h3>

    <!-- ë³¸ë¬¸ -->
    <div id="modalContent"
         class="text-[17px] text-gray-700 leading-[1.9] tracking-[0.01em] font-['Noto_Serif']
                text-justify whitespace-pre-line">
    </div>

    <!-- ë‹«ê¸° ë²„íŠ¼ -->
    <div class="text-center mt-10">
      <button onclick="closeTextModal()"
              class="px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition">
        ë‹«ê¸°
      </button>
    </div>
  </div>
</div>


<!-- JS -->
<script>
function openTextModal(title, content) {
  const modal = document.getElementById('textModal');
  const modalTitle = document.getElementById('modalTitle');
  const modalContent = document.getElementById('modalContent');

  modalTitle.innerText = title;

  // âœ… ë¬¸ë‹¨ ë‹¨ìœ„ ì¤„ë°”ê¿ˆ ì²˜ë¦¬
  const paragraphs = content.split('\n').filter(p => p.trim() !== '');
  modalContent.innerHTML = paragraphs.map(p => `<p class="mb-6 indent-4">${p.trim()}</p>`).join('');

  modal.classList.remove('hidden');
}

function closeTextModal() {
  document.getElementById('textModal').classList.add('hidden');
}
</script>


{% endblock %}
